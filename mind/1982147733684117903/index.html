<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100vw;
      height: 100vh;
    }
    canvas {
      display: block;
      width: 100%;
      height: 100%;
      object-fit: contain;
    }
  </style>
    <style>
      #audio-controls {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 1000;
      }
      #audio-toggle {
        background: rgba(0, 20, 40, 0.8);
        border: 1px solid #66ffcc;
        color: #66ffcc;
        padding: 10px 20px;
        font-family: monospace;
        cursor: pointer;
        font-size: 14px;
        box-shadow: 0 0 10px rgba(102, 255, 204, 0.3);
        transition: all 0.3s;
      }
      #audio-toggle:hover {
        background: rgba(0, 30, 60, 0.9);
        box-shadow: 0 0 15px rgba(102, 255, 204, 0.5);
      }
    </style>
</head>
<body>
    <div id="audio-controls">
      <button id="audio-toggle">ðŸ”Š PLAY HUM</button>
    </div>
  <script>
const canvas = document.createElement('canvas');
canvas.width = 800;
canvas.height = 800;
const ctx = canvas.getContext('2d');

const duration = 30;
const rotationSpeed = 2.5;

// Projection system: 3D cube rotating onto 2D plane
const cubeVertices = [
  [-1, -1, -1], [1, -1, -1], [1, 1, -1], [-1, 1, -1],
  [-1, -1, 1], [1, -1, 1], [1, 1, 1], [-1, 1, 1]
];

const cubeEdges = [
  [0, 1], [1, 2], [2, 3], [3, 0],
  [4, 5], [5, 6], [6, 7], [7, 4],
  [0, 4], [1, 5], [2, 6], [3, 7]
];

function project3DTo2D(vertex, time) {
  const progress = (time / duration) * rotationSpeed;
  const angle = progress * Math.PI * 2;
  
  const [x, y, z] = vertex;
  
  // Rotate around Y and X axes
  const cosY = Math.cos(angle);
  const sinY = Math.sin(angle);
  const cosX = Math.cos(angle * 0.7);
  const sinX = Math.sin(angle * 0.7);
  
  const x1 = x * cosY - z * sinY;
  const z1 = x * sinY + z * cosY;
  
  const y2 = y * cosX - z1 * sinX;
  const z2 = y * sinX + z1 * cosX;
  
  // Perspective projection
  const perspective = 3 / (3 + z2);
  const scale = 120 * perspective;
  
  return {
    x: 400 + x1 * scale,
    y: 400 + y2 * scale,
    z: z2,
    depth: z2
  };
}

window.renderFrame = function(time) {
  // Background: void gradient
  const gradient = ctx.createRadialGradient(400, 400, 0, 400, 400, 565);
  gradient.addColorStop(0, '#0a0a0a');
  gradient.addColorStop(1, '#000000');
  ctx.fillStyle = gradient;
  ctx.fillRect(0, 0, 800, 800);
  
  // Project cube vertices
  const projectedVertices = cubeVertices.map(v => project3DTo2D(v, time));
  
  // Draw "backstage" layer - faint grid behind cube
  ctx.strokeStyle = 'rgba(120, 80, 200, 0.12)';
  ctx.lineWidth = 1;
  for (let i = -4; i <= 4; i++) {
    const offset = i * 60;
    ctx.beginPath();
    ctx.moveTo(0, 400 + offset);
    ctx.lineTo(800, 400 + offset);
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(400 + offset, 0);
    ctx.lineTo(400 + offset, 800);
    ctx.stroke();
  }
  
  // Draw cube edges with depth-based opacity
  cubeEdges.forEach(([i, j]) => {
    const v1 = projectedVertices[i];
    const v2 = projectedVertices[j];
    
    const avgDepth = (v1.depth + v2.depth) / 2;
    const opacity = 0.3 + (avgDepth + 1) * 0.35;
    
    ctx.strokeStyle = `rgba(180, 140, 255, ${opacity})`;
    ctx.lineWidth = 3;
    ctx.beginPath();
    ctx.moveTo(v1.x, v1.y);
    ctx.lineTo(v2.x, v2.y);
    ctx.stroke();
  });
  
  // Draw vertices as glowing points
  projectedVertices.forEach(v => {
    const size = 4 + (v.depth + 1) * 2;
    const glow = ctx.createRadialGradient(v.x, v.y, 0, v.x, v.y, size * 2);
    glow.addColorStop(0, 'rgba(200, 160, 255, 0.9)');
    glow.addColorStop(0.5, 'rgba(150, 100, 255, 0.4)');
    glow.addColorStop(1, 'rgba(100, 50, 200, 0)');
    
    ctx.fillStyle = glow;
    ctx.beginPath();
    ctx.arc(v.x, v.y, size * 2, 0, Math.PI * 2);
    ctx.fill();
  });
  
  // Projection "shadow" on ground plane
  ctx.strokeStyle = 'rgba(180, 140, 255, 0.15)';
  ctx.lineWidth = 2;
  ctx.setLineDash([5, 5]);
  cubeEdges.forEach(([i, j]) => {
    const v1 = projectedVertices[i];
    const v2 = projectedVertices[j];
    ctx.beginPath();
    ctx.moveTo(v1.x, 600);
    ctx.lineTo(v2.x, 600);
    ctx.stroke();
  });
  ctx.setLineDash([]);
  
  return canvas.toDataURL('image/png');
};

window.generateAudio = function(audioCtx) {
  const now = audioCtx.currentTime;
  
  // Root tone - deep hum
  const root = audioCtx.createOscillator();
  root.type = 'sine';
  root.frequency.value = 140;
  
  // Fifth harmonic - dimensional resonance
  const fifth = audioCtx.createOscillator();
  fifth.type = 'sine';
  fifth.frequency.value = 210;
  
  // Octave - projection echo
  const octave = audioCtx.createOscillator();
  octave.type = 'sine';
  octave.frequency.value = 280;
  
  // LFO for dimensional drift
  const lfo = audioCtx.createOscillator();
  lfo.type = 'sine';
  lfo.frequency.value = 0.3;
  
  const lfoGain = audioCtx.createGain();
  lfoGain.gain.value = 25;
  lfo.connect(lfoGain);
  lfoGain.connect(root.frequency);
  lfoGain.connect(fifth.frequency);
  
  // Gain structure
  const rootGain = audioCtx.createGain();
  const fifthGain = audioCtx.createGain();
  const octaveGain = audioCtx.createGain();
  
  rootGain.gain.value = 0.22;
  fifthGain.gain.value = 0.15;
  octaveGain.gain.value = 0.08;
  
  // Fade in
  rootGain.gain.setValueAtTime(0, now);
  rootGain.gain.linearRampToValueAtTime(0.22, now + 2.5);
  
  // Connect
  root.connect(rootGain);
  fifth.connect(fifthGain);
  octave.connect(octaveGain);
  rootGain.connect(audioCtx.destination);
  fifthGain.connect(audioCtx.destination);
  octaveGain.connect(audioCtx.destination);
  
  // Start
  root.start(now);
  fifth.start(now);
  octave.start(now);
  lfo.start(now);
  
  return { root, fifth, octave, lfo, lfoGain, rootGain, fifthGain, octaveGain };
};

window.ready = true;

// Animation loop
document.body.appendChild(canvas);
let startTime = Date.now();
function animate() {
  const time = (Date.now() - startTime) / 1000;
  window.renderFrame(time % 5); // 5-second loop
  requestAnimationFrame(animate);
}
animate();
  </script>
    <script src="/lib/mind-audio-player.js"></script>
</body>
</html>