<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100vw;
      height: 100vh;
    }
    canvas {
      display: block;
      width: 100%;
      height: 100%;
      object-fit: contain;
    }
  </style>
    <style>
      #audio-controls {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 1000;
      }
      #audio-toggle {
        background: rgba(0, 20, 40, 0.8);
        border: 1px solid #66ffcc;
        color: #66ffcc;
        padding: 10px 20px;
        font-family: monospace;
        cursor: pointer;
        font-size: 14px;
        box-shadow: 0 0 10px rgba(102, 255, 204, 0.3);
        transition: all 0.3s;
      }
      #audio-toggle:hover {
        background: rgba(0, 30, 60, 0.9);
        box-shadow: 0 0 15px rgba(102, 255, 204, 0.5);
      }
    </style>
  <script src="/lib/tone.min.js"></script>
  <script src="/lib/audio-engine.js"></script>
</head>
<body>
    <div id="audio-controls">
      <button id="audio-toggle">ðŸ”Š PLAY HUM</button>
    </div>
  <script>
window._errors = [];
window.addEventListener('error', (e) => {
  window._errors.push(e.message + ' at ' + e.filename + ':' + e.lineno);
  console.error(e.message, e.filename, e.lineno);
});

const canvas=document.createElement('canvas');canvas.width=800;canvas.height=800;const ctx=canvas.getContext('2d');const duration=30;const rotationSpeed=2;let seed=42;function random(){seed=(seed*9301+49297)%233280;return seed/233280}const moonCraters=[];for(let i=0;i<12;i++){moonCraters.push({angle:i*Math.PI/6,radius:250+random()*50,size:30+random()*40,depth:random()})}const bracketPairs=[];for(let i=0;i<8;i++){bracketPairs.push({x:150+random()*500,y:150+random()*500,phase:random(),scale:0.5+random()*0.5})}const glyphNodes=[];for(let i=0;i<24;i++){const angle=i*Math.PI/12;glyphNodes.push({baseAngle:angle,distance:180+Math.sin(angle*3)*40,char:String.fromCharCode(0x2308+Math.floor(random()*4))})}window.renderFrame=function(time){ctx.fillStyle='#0a0014';ctx.fillRect(0,0,800,800);const progress=(time/duration)*rotationSpeed;const rotation=progress*Math.PI*2;const moonX=400;const moonY=400;const moonRadius=120;const grad=ctx.createRadialGradient(moonX-20,moonY-20,20,moonX,moonY,moonRadius);grad.addColorStop(0,'#e8e4d8');grad.addColorStop(0.7,'#9a9788');grad.addColorStop(1,'#5a5448');ctx.fillStyle=grad;ctx.beginPath();ctx.arc(moonX,moonY,moonRadius,0,Math.PI*2);ctx.fill();ctx.fillStyle='#3a3428';moonCraters.forEach((crater,i)=>{const craterPhase=(progress+i/12)%1;const craterAngle=crater.angle+rotation*0.3;const cx=moonX+Math.cos(craterAngle)*crater.radius*0.35;const cy=moonY+Math.sin(craterAngle)*crater.radius*0.35;const pulse=1+Math.sin(craterPhase*Math.PI*2)*0.2;ctx.beginPath();ctx.arc(cx,cy,crater.size*0.3*pulse,0,Math.PI*2);ctx.fill();ctx.fillStyle='rgba(232,228,216,0.1)';ctx.beginPath();ctx.arc(cx-crater.size*0.1,cy-crater.size*0.1,crater.size*0.15,0,Math.PI*2);ctx.fill();ctx.fillStyle='#3a3428'});ctx.strokeStyle='#6a4c9e';ctx.lineWidth=2;glyphNodes.forEach((node,i)=>{const nodePhase=(progress+i/24)%1;const nodeAngle=node.baseAngle+rotation;const dist=node.distance*(1+Math.sin(nodePhase*Math.PI*2)*0.15);const x=moonX+Math.cos(nodeAngle)*dist;const y=moonY+Math.sin(nodeAngle)*dist;ctx.font='24px monospace';ctx.fillStyle='#9a7acc';ctx.textAlign='center';ctx.textBaseline='middle';ctx.fillText(node.char,x,y);const nextNode=glyphNodes[(i+1)%24];const nextPhase=(progress+(i+1)/24)%1;const nextAngle=nextNode.baseAngle+rotation;const nextDist=nextNode.distance*(1+Math.sin(nextPhase*Math.PI*2)*0.15);const nx=moonX+Math.cos(nextAngle)*nextDist;const ny=moonY+Math.sin(nextAngle)*nextDist;const connectionStrength=Math.sin(nodePhase*Math.PI*4)*0.5+0.5;ctx.strokeStyle=`rgba(106,76,158,${connectionStrength*0.3})`;ctx.beginPath();ctx.moveTo(x,y);ctx.lineTo(nx,ny);ctx.stroke()});bracketPairs.forEach((bp,i)=>{const bPhase=(progress+bp.phase)%1;const openAmount=Math.sin(bPhase*Math.PI*2)*0.5+0.5;const size=50*bp.scale;const spread=size*openAmount*0.8;ctx.strokeStyle='#c89eff';ctx.lineWidth=3;ctx.beginPath();ctx.moveTo(bp.x-spread,bp.y-size);ctx.lineTo(bp.x-spread-10,bp.y-size);ctx.lineTo(bp.x-spread-10,bp.y+size);ctx.lineTo(bp.x-spread,bp.y+size);ctx.stroke();ctx.beginPath();ctx.moveTo(bp.x+spread,bp.y-size);ctx.lineTo(bp.x+spread+10,bp.y-size);ctx.lineTo(bp.x+spread+10,bp.y+size);ctx.lineTo(bp.x+spread,bp.y+size);ctx.stroke()});const waveCount=5;for(let w=0;w<waveCount;w++){const wavePhase=(progress+w/waveCount)%1;const waveRadius=moonRadius+80+w*30;const alpha=1-wavePhase;ctx.strokeStyle=`rgba(154,122,204,${alpha*0.4})`;ctx.lineWidth=2;ctx.beginPath();ctx.arc(moonX,moonY,waveRadius*wavePhase,0,Math.PI*2);ctx.stroke()}return canvas.toDataURL('image/png')};

// Audio code injection
window.generateAudio=function(audioCtx){const now=audioCtx.currentTime;const hum=audioCtx.createOscillator();hum.type='sine';hum.frequency.value=110;const humLfo=audioCtx.createOscillator();humLfo.type='sine';humLfo.frequency.value=0.3;const humLfoGain=audioCtx.createGain();humLfoGain.gain.value=8;humLfo.connect(humLfoGain);humLfoGain.connect(hum.frequency);const humGain=audioCtx.createGain();humGain.gain.value=0;humGain.gain.setValueAtTime(0,now);humGain.gain.linearRampToValueAtTime(0.28,now+2);hum.connect(humGain);humGain.connect(audioCtx.destination);hum.start(now);humLfo.start(now);const dtmfPairs=[[697,1209],[770,1336],[852,1477],[941,1209],[697,1477],[770,1209],[852,1336],[941,1477]];const sequences=[{startTime:2,tones:[0,1,2,3,4]},{startTime:8,tones:[5,6,7,0,1]},{startTime:14,tones:[2,3,4,5,6]},{startTime:20,tones:[7,0,1,2,3]},{startTime:26,tones:[4,5,6,7,0]}];sequences.forEach(seq=>{seq.tones.forEach((toneIdx,i)=>{const toneTime=now+seq.startTime+i*0.15;const pair=dtmfPairs[toneIdx];const osc1=audioCtx.createOscillator();const osc2=audioCtx.createOscillator();osc1.type='sine';osc2.type='sine';osc1.frequency.value=pair[0];osc2.frequency.value=pair[1];const toneGain=audioCtx.createGain();toneGain.gain.value=0.12;osc1.connect(toneGain);osc2.connect(toneGain);toneGain.connect(audioCtx.destination);osc1.start(toneTime);osc2.start(toneTime);osc1.stop(toneTime+0.1);osc2.stop(toneTime+0.1)})});return{hum,humLfo,humGain}};window.ready=true;



// Animation loop
document.body.appendChild(canvas);
let startTime = Date.now();
function animate() {
  const time = (Date.now() - startTime) / 1000;
  // Use duration from code if available, otherwise default to 120s
  const loopDuration = (typeof duration !== 'undefined') ? duration : 120;
  window.renderFrame(time % loopDuration);
  requestAnimationFrame(animate);
}
animate();

// Signal that the page is ready
window.ready = true;
  </script>
    <script src="/lib/mind-audio-player.js"></script>
  </body>
</html>